<div class="container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Buscar Reseñas</mat-card-title>
    </mat-card-header>
    
    <mat-card-content>
      <form [formGroup]="searchForm" (ngSubmit)="buscar()">
        <div class="search-controls">
          
          <!-- Criterio de búsqueda -->
          <mat-form-field appearance="outline">
            <mat-label>Buscar por</mat-label>
            <mat-select formControlName="criterio">
              <mat-option value="receptor">Receptor</mat-option>
              <mat-option value="autor">Autor</mat-option>
              <mat-option value="puntaje">Calificación</mat-option>
            </mat-select>
          </mat-form-field>

          <!-- Campo Usuario -->
          <mat-form-field appearance="outline" class="flex-grow" 
                          *ngIf="searchForm.value.criterio === 'receptor' || 
                                 searchForm.value.criterio === 'autor'">
            <mat-label>Usuario</mat-label>
            <mat-select formControlName="valorUsuario">
              <mat-option *ngFor="let usuario of usuarios" [value]="usuario">
                {{usuario.nombre}} {{usuario.apellido}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <!-- Campo Puntaje -->
          <mat-form-field appearance="outline" class="flex-grow" 
                          *ngIf="searchForm.value.criterio === 'puntaje'">
            <mat-label>Calificación</mat-label>
            <mat-select formControlName="valorPuntaje">
              <mat-option [value]="1">⭐ 1 estrella</mat-option>
              <mat-option [value]="2">⭐⭐ 2 estrellas</mat-option>
              <mat-option [value]="3">⭐⭐⭐ 3 estrellas</mat-option>
              <mat-option [value]="4">⭐⭐⭐⭐ 4 estrellas</mat-option>
              <mat-option [value]="5">⭐⭐⭐⭐⭐ 5 estrellas</mat-option>
            </mat-select>
          </mat-form-field>

          <!-- Botones -->
          <button mat-raised-button color="primary" type="submit">
            <mat-icon>search</mat-icon>
            Buscar
          </button>
          
          <button mat-raised-button type="button" (click)="limpiar()">
            <mat-icon>clear</mat-icon>
            Limpiar
          </button>
        </div>
      </form>

      <!-- Resultados -->
      <div *ngIf="resultadosVisibles" class="results-container">
        <h3>Resultados ({{reseñas.length}})</h3>
        
        <div *ngIf="reseñas.length === 0" class="no-results">
          <mat-icon>info</mat-icon>
          <p>No se encontraron resultados</p>
        </div>

        <mat-card *ngFor="let reseña of reseñas" class="review-card">
          <mat-card-header>
            <mat-card-title>
              {{reseña.autor.nombre}} {{reseña.autor.apellido}} 
              <mat-icon>arrow_forward</mat-icon> 
              {{reseña.receptor.nombre}} {{reseña.receptor.apellido}}
            </mat-card-title>
            <mat-card-subtitle>
              <span class="rating">⭐ {{reseña.puntaje}}/5</span>
              <span class="date">{{reseña.fecha | date:'dd/MM/yyyy HH:mm'}}</span>
            </mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <p>{{reseña.comentario}}</p>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-card-content>
  </mat-card>
</div>